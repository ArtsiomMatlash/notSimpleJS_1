Старался делать самостоятельно, обращаясь к учебнику. Криво, долго, длинно, но вроде работает =)